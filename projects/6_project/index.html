<!DOCTYPE html> <html lang="en"> <head> <meta http-equiv="Content-Type" content="text/html; charset=UTF-8"> <meta charset="utf-8"> <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"> <meta http-equiv="X-UA-Compatible" content="IE=edge"> <title> Fun With Diffusion Models | Cyprian Zander </title> <meta name="author" content="Cyprian Zander"> <meta name="description" content="November 14, 2025"> <meta name="keywords" content="machine-learning, computer-science, berkeley, uc-berkeley, portfolio, research, data-science, software-engineering, academic, publications, artificial-intelligence, deep-learning, neural-networks, python, programming, algorithms, statistics, mathematics, cs-student, undergraduate, research-assistant, github, open-source, technical-writing, academic-website, personal-website, student-portfolio, cs180, cs61a, cs61b, cs70, cs188, cs189, launchpad, berkeley-launchpad, startup, entrepreneurship, technology, innovation, stem, education, university, california, bay-area, silicon-valley"> <link rel="stylesheet" href="/assets/css/bootstrap.min.css?a4b3f509e79c54a512b890d73235ef04"> <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/mdbootstrap@4.20.0/css/mdb.min.css" integrity="sha256-jpjYvU3G3N6nrrBwXJoVEYI/0zw8htfFnhT9ljN3JJw=" crossorigin="anonymous"> <link defer rel="stylesheet" href="/assets/css/academicons.min.css?f0b7046b84e425c55f3463ac249818f5"> <link defer rel="stylesheet" href="/assets/css/scholar-icons.css?62b2ac103a88034e6882a5be5f3e2772"> <link defer rel="stylesheet" type="text/css" href="https://fonts.googleapis.com/css?family=Roboto:300,400,500,700|Roboto+Slab:100,300,400,500,700|Material+Icons&amp;display=swap"> <link defer rel="stylesheet" href="/assets/css/jekyll-pygments-themes-github.css?591dab5a4e56573bf4ef7fd332894c99" media="" id="highlight_theme_light"> <link rel="shortcut icon" href="/assets/img/favico.ico?ba4125972f729e5643234e8f9a65339e"> <link rel="stylesheet" href="/assets/css/main.css?d41d8cd98f00b204e9800998ecf8427e"> <link rel="canonical" href="https://zanderfilet.github.io/projects/6_project/"> <script src="/assets/js/theme.js?a81d82887dd692e91686b43de4542f18"></script> <link defer rel="stylesheet" href="/assets/css/jekyll-pygments-themes-native.css?5847e5ed4a4568527aa6cfab446049ca" media="none" id="highlight_theme_dark"> <script>
    initTheme();
  </script> </head> <body class="fixed-top-nav "> <header> <nav id="navbar" class="navbar navbar-light navbar-expand-sm fixed-top" role="navigation"> <div class="container"> <a class="navbar-brand title font-weight-lighter" href="/"> <span class="font-weight-bold">Cyprian</span> Zander </a> <button class="navbar-toggler collapsed ml-auto" type="button" data-toggle="collapse" data-target="#navbarNav" aria-controls="navbarNav" aria-expanded="false" aria-label="Toggle navigation"> <span class="sr-only">Toggle navigation</span> <span class="icon-bar top-bar"></span> <span class="icon-bar middle-bar"></span> <span class="icon-bar bottom-bar"></span> </button> <div class="collapse navbar-collapse text-right" id="navbarNav"> <ul class="navbar-nav ml-auto flex-nowrap"> <li class="nav-item "> <a class="nav-link" href="/">about </a> </li> <li class="nav-item "> <a class="nav-link" href="/books/">bookshelf </a> </li> <li class="nav-item "> <a class="nav-link" href="/blog/">blog </a> </li> <li class="nav-item active"> <a class="nav-link" href="/projects/">projects <span class="sr-only">(current)</span> </a> </li> <li class="nav-item "> <a class="nav-link" href="/photography/">photography </a> </li> <li class="nav-item"> <button id="search-toggle" title="Search" onclick="openSearchModal()"> <span class="nav-link">ctrl k <i class="ti ti-search"></i></span> </button> </li> <li class="toggle-container"> <button id="light-toggle" title="Change theme"> <i class="ti ti-sun-moon" id="light-toggle-system"></i> <i class="ti ti-moon-filled" id="light-toggle-dark"></i> <i class="ti ti-sun-filled" id="light-toggle-light"></i> </button> </li> </ul> </div> </div> </nav> <progress id="progress" value="0"> <div class="progress-container"> <span class="progress-bar"></span> </div> </progress> </header> <div class="container mt-5" role="main"> <div class="post"> <header class="post-header"> <h1 class="post-title">Fun With Diffusion Models</h1> <p class="post-description">November 14, 2025</p> </header> <article> <h3 id="overview">Overview</h3> <p>Overview!! Overvieww!!!</p> <hr> <h3 id="part-a-the-power-of-diffusion-models">Part A: The Power of Diffusion Models</h3> <p>babababa</p> <h5 id="part-0-setup">Part 0: Setup</h5> <p>Come up with some interesting text prompts and generate their embeddings. Choose 3 of your prompts to generate images and display the caption and the output of the model. Reflect on the quality of the outputs and their relationships to the text prompts. Make sure to try at least 2 different num_inference_steps values. Report the random seed that you’re using here. You should use the same seed all subsequent parts.</p> <h5 id="part-1-sampling-loops">Part 1: Sampling Loops</h5> <p>Overview</p> <h5 id="11-implementing-the-forward-process">1.1: Implementing the Forward Process</h5> <p>Implement the noisy_im = forward(im, t) function Show the Campanile at noise level [250, 500, 750].</p> <h5 id="12-classical-denoising">1.2: Classical Denoising</h5> <p>For each of the 3 noisy Campanile images from the previous part, show your best Gaussian-denoised version side by side.</p> <h5 id="13-one-step-denoising">1.3: One-Step Denoising</h5> <p>For the 3 noisy images from 1.2 (t = [250, 500, 750]): Use your forward function to add noise to your Campanile. Estimate the noise in the new noisy image, by passing it through stage_1.unet Remove the noise from the noisy image to obtain an estimate of the original image. Visualize the original image, the noisy image, and the estimate of the original image</p> <h5 id="14-iterative-denoising">1.4: Iterative Denoising</h5> <p>Using i_start = 10: Create strided_timesteps: a list of monotonically decreasing timesteps, starting at 990, with a stride of 30, eventually reaching 0. Also initialize the timesteps using the function stage_1.scheduler.set_timesteps(timesteps=strided_timesteps) Complete the iterative_denoise function Show the noisy Campanile every 5th loop of denoising (it should gradually become less noisy) Show the final predicted clean image, using iterative denoising Show the predicted clean image using only a single denoising step, as was done in the previous part. This should look much worse. Show the predicted clean image using gaussian blurring, as was done in part 1.2.</p> <h5 id="15-diffusion-model-sampling">1.5: Diffusion Model Sampling</h5> <p>Show 5 sampled images.</p> <h5 id="16-classifier-free-guidance-cfg">1.6: Classifier-Free Guidance (CFG)</h5> <p>Implement the iterative_denoise_cfg function Show 5 images of “a high quality photo” with a CFG scale of gamma = 7. Now this prompt becomes a condition (but fairly weak) to generate conditional noise! You will use your customized prompts as stronger conditions in part 1.7 - part 1.9.</p> <h5 id="17-image-to-image-translation">1.7: Image-to-image Translation</h5> <p>Edits of the Campanile image, using the given prompt at noise levels [1, 3, 5, 7, 10, 20] with the conditional text prompt “a high quality photo” Edits of 2 of your own test images, using the same procedure.</p> <h5 id="171-editing-hand-drawn-and-web-images">1.7.1: Editing Hand-Drawn and Web Images</h5> <p>1 image from the web of your choice, edited using the above method for noise levels [1, 3, 5, 7, 10, 20] (and whatever additional noise levels you want) 2 hand drawn images, edited using the above method for noise levels [1, 3, 5, 7, 10, 20] (and whatever additional noise levels you want)</p> <h5 id="172-inpainting">1.7.2: Inpainting</h5> <p>A properly implemented inpaint function The Campanile inpainted (feel free to use your own mask) 2 of your own images edited (come up with your own mask) look at the results from this paper for inspiration</p> <h5 id="173-text-conditional-image-to-image-translation">1.7.3: Text-Conditional Image-to-image Translation</h5> <p>Edits of the Campanile, using the given prompt at noise levels [1, 3, 5, 7, 10, 20] Edits of 2 of your own test images, using the same procedure</p> <h5 id="18-visual-anagrams">1.8: Visual Anagrams</h5> <p>Correctly implemented visual_anagrams function 2 illusions of your choice that change appearance when you flip it upside down (feel free to take inspirations from this page).</p> <h5 id="19-hybrid-images">1.9: Hybrid Images</h5> <p>Correctly implemented make_hybrids function 2 hybrid images of your choosing (feel free to take inspirations from this page).</p> <h3 id="part-b-flow-matching-from-scratch">Part B: Flow Matching from Scratch</h3> <h5 id="part-1-training-a-single-step-denoising-unet">Part 1: Training a Single-Step Denoising UNet</h5> <h5 id="11-implementing-the-unet">1.1: Implementing the UNet</h5> <h5 id="12-using-the-unet-to-train-a-denoiser">1.2: Using the UNet to Train a Denoiser</h5> <p>A visualization of the noising process using</p> <h5 id="121-training">1.2.1: Training</h5> <p>A training loss curve plot every few iterations during the whole training process of . Sample results on the test set with noise level 0.5 after the first and the 5-th epoch (staff solution takes ~3 minutes for 5 epochs on a Colab T4 GPU).</p> <h5 id="122-out-of-distribution-testing">1.2.2: Out-of-Distribution Testing</h5> <p>Sample results on the test set with out-of-distribution noise levels after the model is trained. Keep the same image and vary</p> <h5 id="123-denoising-pure-noise">1.2.3: Denoising Pure Noise</h5> <p>A training loss curve plot every few iterations during the whole training process that denoises pure noise. Sample results on pure noise after the first and the 5-th epoch. A brief description of the patterns observed in the generated outputs and explanations for why they may exist.</p> <h5 id="part-2-training-a-flow-matching-model">Part 2: Training a Flow Matching Model</h5> <h5 id="21-adding-time-conditioning-to-unet">2.1: Adding Time Conditioning to UNet</h5> <h5 id="22-training-the-unet">2.2: Training the UNet</h5> <h5 id="23-sampling-from-the-unet">2.3: Sampling from the UNet</h5> <p>A training loss curve plot for the time-conditioned UNet over the whole training process.</p> <h5 id="24-adding-class-conditioning-to-unet">2.4: Adding Class-Conditioning to UNet</h5> <p>Sampling results from the time-conditioned UNet for 1, 5, and 10 epochs. The results should not be perfect, but reasonably good. (Optional for CS180, required for CS280A) Check the Bells and Whistles if you want to make it better!</p> <h5 id="25-training-the-unet">2.5: Training the UNet</h5> <p>A training loss curve plot for the class-conditioned UNet over the whole training process.</p> <h5 id="26-sampling-from-the-unet">2.6: Sampling from the UNet</h5> <p>Sampling results from the class-conditioned UNet for 1, 5, and 10 epochs. Class-conditioning lets us converge faster, hence why we only train for 10 epochs. Generate 4 instances of each digit as shown above. Can we get rid of the annoying learning rate scheduler? Simplicity is the best. Please try to maintain the same performance after removing the exponential learning rate scheduler. Show your visualization after training without the scheduler and provide a description of what you did to compensate for the loss of the scheduler.</p> </article> </div> </div> <footer class="fixed-bottom" role="contentinfo"> <div class="container mt-0"> © Copyright 2025 Cyprian Zander. </div> </footer> <script src="https://cdn.jsdelivr.net/npm/jquery@3.6.0/dist/jquery.min.js" integrity="sha256-/xUj+3OJU5yExlq6GSYGSHk7tPXikynS7ogEvDej/m4=" crossorigin="anonymous"></script> <script src="/assets/js/bootstrap.bundle.min.js"></script> <script src="https://cdn.jsdelivr.net/npm/mdbootstrap@4.20.0/js/mdb.min.js" integrity="sha256-NdbiivsvWt7VYCt6hYNT3h/th9vSTL4EDWeGs5SN3DA=" crossorigin="anonymous"></script> <script defer src="https://cdn.jsdelivr.net/npm/masonry-layout@4.2.2/dist/masonry.pkgd.min.js" integrity="sha256-Nn1q/fx0H7SNLZMQ5Hw5JLaTRZp0yILA/FRexe19VdI=" crossorigin="anonymous"></script> <script defer src="https://cdn.jsdelivr.net/npm/imagesloaded@5.0.0/imagesloaded.pkgd.min.js" integrity="sha256-htrLFfZJ6v5udOG+3kNLINIKh2gvoKqwEhHYfTTMICc=" crossorigin="anonymous"></script> <script defer src="/assets/js/masonry.js?a0db7e5d5c70cc3252b3138b0c91dcaf" type="text/javascript"></script> <script defer src="https://cdn.jsdelivr.net/npm/medium-zoom@1.1.0/dist/medium-zoom.min.js" integrity="sha256-ZgMyDAIYDYGxbcpJcfUnYwNevG/xi9OHKaR/8GK+jWc=" crossorigin="anonymous"></script> <script defer src="/assets/js/zoom.js?85ddb88934d28b74e78031fd54cf8308"></script> <script src="/assets/js/no_defer.js?2781658a0a2b13ed609542042a859126"></script> <script defer src="/assets/js/common.js?e0514a05c5c95ac1a93a8dfd5249b92e"></script> <script defer src="/assets/js/copy_code.js?c8a01c11a92744d44b093fc3bda915df" type="text/javascript"></script> <script defer src="/assets/js/jupyter_new_tab.js?d9f17b6adc2311cbabd747f4538bb15f"></script> <script async src="https://d1bxh8uas1mnw7.cloudfront.net/assets/embed.js"></script> <script async src="https://badge.dimensions.ai/badge.js"></script> <script defer type="text/javascript" id="MathJax-script" src="https://cdn.jsdelivr.net/npm/mathjax@3.2.2/es5/tex-mml-chtml.js" integrity="sha256-MASABpB4tYktI2Oitl4t+78w/lyA+D7b/s9GEP0JOGI=" crossorigin="anonymous"></script> <script src="/assets/js/mathjax-setup.js?a5bb4e6a542c546dd929b24b8b236dfd"></script> <script defer src="https://cdnjs.cloudflare.com/polyfill/v3/polyfill.min.js?features=es6" crossorigin="anonymous"></script> <script defer src="/assets/js/progress-bar.js?2f30e0e6801ea8f5036fa66e1ab0a71a" type="text/javascript"></script> <script src="/assets/js/vanilla-back-to-top.min.js?f40d453793ff4f64e238e420181a1d17"></script> <script>
    addBackToTop();
  </script> <script type="module" src="/assets/js/search/ninja-keys.min.js?a3446f084dcaecc5f75aa1757d087dcf"></script> <ninja-keys hidebreadcrumbs noautoloadmdicons placeholder="Type to start searching"></ninja-keys> <script src="/assets/js/search-setup.js?6c304f7b1992d4b60f7a07956e52f04a"></script> <script src="/assets/js/search-data.js"></script> <script src="/assets/js/shortcut-key.js?6f508d74becd347268a7f822bca7309d"></script> </body> </html>